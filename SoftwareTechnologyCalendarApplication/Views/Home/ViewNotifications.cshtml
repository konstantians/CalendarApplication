@model User

@{
    ViewData["Title"] = "View Notifications";
    int count = 0;
    int initialCountSection2 = 0;
    int initialCountSection3 = 0;
}

<style>
    .notification-box {
        border: 1px solid #ccc;
        border-radius: 4px;
        padding: 10px;
        margin-bottom: 5px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #fafafa
    }

    .notification-title {
        margin: 0;
    }

    .notification-btn {
        border: none;
        background: none;
        cursor: pointer;
        margin-top:0;
    }

    .notification-check-btn {
        color: blue;
    }

    .notification-close-btn {
        color: red;
    }

    .marker {
    }

    /* Styles for the cool bubbles */
    .badge {
        display: inline-block;
        padding: 6px 10px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 500;
        /*background-color: #007bff;*/
        color: #fff;
    }

    .badge-accepted{
        background-color: #5cb85c;
    }

    .badge-rejected{
        background-color: #dc3545;
    }
</style>

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 16 16">
        <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
    </symbol>
</svg>
@if ((bool)ViewData["NoCalendarSelected"])
{
    <div class="alert alert-danger d-flex align-items-center alert-dismissible fade show" role="alert">
        <svg class="bi flex-shrink-0 mr-2" width="24" height="24" role="img" aria-label="Danger:"><use xlink:href="#exclamation-triangle-fill" /></svg>
        <div>
            You must choose a valid calendar to accept an invitation.
        </div>
        <button type="button" class="close" data-dismiss="alert">&times;</button>
    </div>
}

<div class="mt-1 mb-2 pt-2 pb-2 shadow" style="background-color: white;">
    <h1 class="h1 text-center">Account Notifications</h1>
    <h4 class="h4 text-center">Here You Can See And Delete Your Notifications</h4>
</div>
<div class="shadow pt-4 pb-4 pl-4 pr-4" style="background-color: white;">
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-6 marker mb-3">
            <div class="d-flex justify-content-between mt-3 mb-2">
                <div></div>
                <h4>User Invitations</h4>
                <a class="btn btn-primary" data-toggle="collapse" href="#InvitationsSection" role="button" aria-expanded="false"
                    aria-controls="InvitationsSection" id="showInvitationsButton">
                    <i id="showInvitationsButtonIcon" class="fa-solid fa-chevron-up"></i>
                </a>
            </div>
            <div id="InvitationsSection" class="collapse show">
                @foreach (Notification notification in Model.Notifications)
                {
                    @if (notification.InvitationPending)
                    {
                        <div class="notification-box" id="notification-box-@count">
                            <div class="flex-grow-1 d-flex justify-content-between align-items-top">
                                <p class="notification-title">Sent At: <span style="font-weight:bold">@notification.NotificationTime</span><br> 
                                    From User: <span style="font-weight:bold">@notification.SenderUser.Username</span></p>
                                <div>
                                    <button type="button" class="btn btn-primary notification-btn notification-check-btn" data-toggle="modal" data-target="#viewModal-@count">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button type="button" class="btn btn-primary notification-btn notification-check-btn" data-toggle="modal" data-target="#acceptModal-@count">
                                        <i class="fa-solid fa-calendar-plus"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger notification-btn notification-close-btn" onclick="removeNotification('@count')">
                                        <i class="fa-solid fa-x"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger notification-btn notification-close-btn" data-toggle="modal" data-target="#deleteModal-@count">
                                        <i class="fa-solid fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- View Event Modal -->
                        <div class="modal fade" id="viewModal-@count" tabindex="-1" role="dialog" aria-labelledby="viewModalLabel-@count" aria-hidden="true">
                            <div class="modal-dialog modal-lg" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="viewModalLabel-@count">Event Information</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <h4 class="text-center d-none d-sm-none d-md-block">Event Information</h4>
                                                <div class="d-block d-sm-block d-md-none">
                                                    <div class="d-flex justify-content-between mt-3 mb-2">
                                                        <div></div>
                                                        <h4>Event Information</h4>
                                                        <a class="btn btn-primary" data-toggle="collapse" href="#eventInformationSection-@count" role="button" aria-expanded="false"
                                                            aria-controls="eventInformationSection-@count" id="showEventInformationButton-@count"
                                                           onclick="toggleSection('showEventInformationButton-@count')">
                                                           @{string eventInformationIconId = $"showEventInformationButton-{@count}Icon";}
                                                            <i id="@eventInformationIconId" class="fa-solid fa-chevron-up"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div id="eventInformationSection-@count" class="collapse show">
                                                    <div class="form-group">
                                                        <label for="title" class="control-label">Title</label>
                                                        <input class="form-control" id="title" value="@notification.EventOfNotification.Title" disabled="disabled" />
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="startingTime" class="control-label">Starting Time</label>
                                                        <input id="startingTime" type="datetime" class="form-control" value="@notification.EventOfNotification.StartingTime" disabled="disabled" />
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="endingTime" class="control-label">Ending Time</label>
                                                        <input id="endingTime" type="datetime" class="form-control" value="@notification.EventOfNotification.EndingTime" disabled="disabled" />
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="description" class="control-label">Description</label>
                                                        <textarea class="form-control" id="description" disabled="disabled" rows="3">@notification.EventOfNotification.Description</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="d-flex justify-content-between mt-2 mt-md-0">
                                                    <div></div>
                                                    <h4>Participants Section</h4>
                                                    <a class="btn btn-primary" data-toggle="collapse" href="#participationSection-@count" role="button" aria-expanded="false"
                                                       aria-controls="participationSection-@count" id="showParticipationButton-@count" onclick="toggleSection('showParticipationButton-@count')">
                                                        @{
                                                            string showParticipationIconId = $"showParticipationButton-{@count}Icon";
                                                        }
                                                        <i id="@showParticipationIconId" class="fa-solid fa-chevron-down"></i>
                                                    </a>
                                                </div>

                                                <div id="participationSection-@count" class="collapse">
                                                    <p> Members Who Participate In The Event: </p>
                                                    <div class="d-flex flex-wrap mt-3">
                                                        @foreach (User user in notification.EventOfNotification.UsersThatParticipateInTheEvent)
                                                        {
                                                            <span class="badge badge-primary mr-2 mb-2">@user.Username</span>
                                                        }
                                                    </div>
                                                </div>

                                                <div class="d-flex justify-content-between mt-3 mb-2">
                                                    <div></div>
                                                    <h4>Comments Section</h4>
                                                    <a class="btn btn-primary" data-toggle="collapse" href="#commentSection-@count" role="button" aria-expanded="false"
                                                       aria-controls="commentSection-@count" id="showCommentButton-@count" onclick="toggleSection('showCommentButton-@count')">
                                                        @{
                                                            string showCommentIconId = $"showCommentButton-{@count}Icon";
                                                        }
                                                        <i id="@showCommentIconId" class="fa-solid fa-chevron-down"></i>
                                                    </a>
                                                </div>
                                                <div id="commentSection-@count" class="collapse mt-2">
                                                    <div id="commentArea">
                                                        @if (notification.EventOfNotification.EventComments.Count == 0)
                                                        {
                                                            <div class="alert alert-info" role="alert" id="noComments">
                                                                <strong>No comments!</strong> There are no comments yet.
                                                            </div>
                                                        }

                                                        @foreach (Comment comment in notification.EventOfNotification.EventComments)
                                                        {
                                                            <div class="card mb-2">
                                                                <div class="card-header">
                                                                    <div class="d-flex justify-content-between">
                                                                        <h5 class="card-title font-weight-bold">
                                                                            <i class="fa-solid fa-user mr-1"></i> @comment.UserWhoMadeTheComment.Username
                                                                        </h5>
                                                                    </div>
                                                                    <p class="card-subtitle text-muted">@comment.CommentDate.ToString()</p>
                                                                </div>
                                                                <div class="card-body">
                                                                    @comment.CommentText
                                                                </div>
                                                            </div>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-dark" data-dismiss="modal">Cancel</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Accept Modal Pop Up -->
                        <div class="modal fade" id="acceptModal-@count" tabindex="-1" role="dialog" aria-labelledby="acceptModalLabel-@count" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="acceptModalLabel-@count">Accept Invitation</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    @*if the user does not have any calendars*@
                                    @if (Model.Calendars.Count == 0)
                                    {
                                        <div class="modal-body">
                                            <div class="alert alert-warning d-flex align-items-center alert-dismissible fade show" role="alert">
                                                <svg class="bi flex-shrink-0 mr-2" width="24" height="24" role="img" aria-label="Danger:"><use xlink:href="#exclamation-triangle-fill" /></svg>
                                                <div style="font-size:13.95px;">
                                                    You must have at least 1 calendar to accept an invitation.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-primary" data-dismiss="modal">OK</button>
                                        </div>
                                    }
                                    @*otherwise show the form*@
                                    else
                                    {
                                        <div class="modal-body">
                                            <form id="acceptForm-@count" method="post" asp-controller="Home" asp-action="AcceptInvitation">
                                                <div class="form-group">
                                                    <label for="calendarSelect">Choose The Calendar Which Will Include The Event</label>
                                                    <select name="calendarId" class="form-control" id="calendarSelect">
                                                        <option value="0">Choose One Of Your Calendar</option>
                                                        @foreach (Calendar calendar in Model.Calendars)
                                                        {
                                                            <option value="@calendar.Id">@calendar.Title</option>
                                                        }
                                                    </select>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <label class="form-check-label mr-2" for="checkbox-x">Get Alert Notifications From The Event </label>
                                                    <input name="alertStatus" class="form-check-input" type="checkbox" id="checkbox-x" style="transform: scale(1.3);">
                                                </div>
                                                <input type="hidden" name="eventId" value="@notification.EventOfNotification.Id" />
                                                <input type="hidden" name="userSenderUsername" value="@notification.SenderUser.Username"/>
                                                <input type="hidden" name="notificationTime" value="@notification.NotificationTime" />
                                            </form>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-dark" data-dismiss="modal">Cancel</button>
                                            <button type="submit" form="acceptForm-@count" class="btn btn-primary">Confirm</button>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>

                        <!-- Delete Modal -->
                        <div class="modal fade" id="deleteModal-@count" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel-@count" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="deleteModalLabel-@count">Notification Confirm Deletion Dialog</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <p>Are you sure you do not want to participate in that event?</p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-dark" data-dismiss="modal">Cancel</button>
                                        <!--fill the form-->
                                        <form method="post" asp-controller="Home" asp-action="RejectInvitation">
                                            <input type="hidden" name="eventId" value="@notification.EventOfNotification.Id" />
                                            <input type="hidden" name="userSenderUsername" value="@notification.SenderUser.Username" />
                                            <input type="hidden" name="notificationTime" value="@notification.NotificationTime" />
                                            <button type="submit" class="btn btn-danger">Confirm</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        //increase the count
                        count++;
                    }
                }

                @if (count == 0)
                {
                    <div class="alert alert-info" role="alert">
                        <strong>No notifications!</strong> There are no notifications for this section.
                    </div>
                }
            </div>
        </div>
        <div class="col-sm-12 col-md-12 col-lg-6 marker mb-3">
            @{
                initialCountSection2 = count;
            }
            <div class="d-flex justify-content-between mt-3 mb-2">
                <div></div>
                <h4>Events Notifications</h4>
                <a class="btn btn-primary" data-toggle="collapse" href="#EventNotificationsSection" role="button" aria-expanded="false"
                   aria-controls="EventNotificationsSection" id="showEventNotificationsButton">
                    <i id="showEventNotificationsButtonIcon" class="fa-solid fa-chevron-up"></i>
                </a>
            </div>
            <div id="EventNotificationsSection" class="collapse show">
                @foreach (Notification notification in Model.Notifications)
                {
                    @if (!notification.InvitationPending && !notification.AlertNotification)
                    {
                        <div class="notification-box" id="notification-box-@count">
                            <div class="flex-grow-1 d-flex justify-content-between align-items-top">
                                @if (notification.EventAccepted)
                                {
                                    <p class="notification-title">
                                        Sent At: <span style="font-weight:bold;">@notification.NotificationTime</span><br>
                                        From User: <span style="font-weight:bold;">@notification.SenderUser.Username</span><br>
                                        Accepted Event: <span style="font-weight:bold;">@notification.EventOfNotification.Title</span>
                                    </p>
                                }
                                @if (notification.EventRejected)
                                {
                                    <p class="notification-title">
                                        Sent At: <span style="font-weight:bold;">@notification.NotificationTime</span><br>
                                        From User: <span style="font-weight:bold;">@notification.SenderUser.Username</span><br>
                                        Rejected Event: <span style="font-weight:bold;">@notification.EventOfNotification.Title</span>
                                    </p>
                                }
                                @if (notification.EventChanged)
                                {
                                    <p class="notification-title">
                                        Sent At: <span style="font-weight:bold;">@notification.NotificationTime</span><br>
                                        From User: <span style="font-weight:bold;">@notification.SenderUser.Username</span><br>
                                        Updated Event: <span style="font-weight:bold;">@notification.EventOfNotification.Title</span>
                                    </p>
                                }
                                @if (notification.CommentAdded)
                                {
                                    <p class="notification-title">
                                        Sent At: <span style="font-weight:bold;">@notification.NotificationTime</span><br>
                                        From User: <span style="font-weight:bold;">@notification.SenderUser.Username</span><br>
                                        Event Of Added Comment: <span style="font-weight:bold;">@notification.EventOfNotification.Title</span>
                                    </p>
                                }
                                @if (notification.CommentDeleted)
                                {
                                    <p class="notification-title">
                                        Sent At: <span style="font-weight:bold;">@notification.NotificationTime</span><br>
                                        From User: <span style="font-weight:bold;">@notification.SenderUser.Username</span><br>
                                        Event Of Deleted Comment: <span style="font-weight:bold;">@notification.EventOfNotification.Title</span>
                                    </p>
                                }
                                @if (notification.EventDeleted)
                                {
                                    <p class="notification-title">
                                        Sent At: <span style="font-weight:bold;">@notification.NotificationTime</span><br>
                                        From User: <span style="font-weight:bold;">@notification.SenderUser.Username</span><br>
                                        @*the creator of the event deleted the event*@
                                        @if(notification.EventOfNotification.EventCreatorName == notification.SenderUser.Username)
                                        {
                                            <span>Deleted Event: <span style="font-weight:bold;">@notification.EventOfNotification.Title</span></span>
                                        }
                                        @*someone left from an event*@
                                        else
                                        {
                                            <span>User Left Event: <span style="font-weight:bold;">@notification.EventOfNotification.Title</span></span>
                                        }
                                    </p>
                                }
                                <div>
                                    <button type="button" class="btn btn-primary notification-btn notification-check-btn" data-toggle="modal" data-target="#viewModal-@count">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger notification-btn notification-close-btn" onclick="removeNotification('@count')">
                                        <i class="fa-solid fa-x"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger notification-btn notification-close-btn" data-toggle="modal" data-target="#myModal-@count">
                                        <i class="fa-solid fa-trash"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- View Event Modal -->
                            <div class="modal fade" id="viewModal-@count" tabindex="-1" role="dialog" aria-labelledby="viewModalLabel-@count" aria-hidden="true">
                                <div class="modal-dialog modal-lg" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            @if(notification.EventAccepted){
                                                <h5 class="modal-title" id="viewModalLabel-@count">Accepted Event <span style="font-weight:bold;">@notification.EventOfNotification.Title</span> From User <span style="font-weight:bold;">@notification.SenderUser.Username</span></h5>
                                            }
                                            else if(notification.EventRejected){
                                                <h5 class="modal-title" id="viewModalLabel-@count">Rejected Event <span style="font-weight:bold;">@notification.EventOfNotification.Title</span> From User <span style="font-weight:bold;">@notification.SenderUser.Username</span></h5>
                                            }
                                            else if (notification.EventChanged)
                                            {
                                                <h5 class="modal-title" id="viewModalLabel-@count">Updated Event <span style="font-weight:bold;">@notification.EventOfNotification.Title</span> From User <span style="font-weight:bold;">@notification.SenderUser.Username</span></h5>
                                            }
                                            else if (notification.CommentAdded)
                                            {
                                                <h5 class="modal-title" id="viewModalLabel-@count">Comment Added To <span style="font-weight:bold;">@notification.EventOfNotification.Title</span> From User <span style="font-weight:bold;">@notification.SenderUser.Username</span></h5>
                                            }
                                            else if (notification.CommentDeleted)
                                            {
                                                <h5 class="modal-title" id="viewModalLabel-@count">Comment Deleted From Event <span style="font-weight:bold;">@notification.EventOfNotification.Title</span> From User <span style="font-weight:bold;">@notification.SenderUser.Username</span></h5>
                                            }
                                            else if (notification.EventDeleted)
                                            {
                                                @*the creator of the event deleted the event*@
                                                @if (notification.EventOfNotification.EventCreatorName == notification.SenderUser.Username)
                                                {
                                                    <h5 class="modal-title" id="viewModalLabel-@count">Event <span style="font-weight:bold;">@notification.EventOfNotification.Title</span> Deleted From Creator Of Event <span style="font-weight:bold;">@notification.SenderUser.Username</span></h5>
                                                }
                                                @*someone left from an event*@
                                                else
                                                {
                                                    <h5 class="modal-title" id="viewModalLabel-@count">User <span style="font-weight:bold;">@notification.SenderUser.Username</span> Left The Event <span style="font-weight:bold;">@notification.EventOfNotification.Title</span></h5>
                                                }
                                            }
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <h4 class="text-center d-none d-sm-none d-md-block">Event Information</h4>
                                                    <div class="d-block d-sm-block d-md-none">
                                                        <div class="d-flex justify-content-between mt-3 mb-2">
                                                            <div></div>
                                                            <h4>Event Information</h4>
                                                            <a class="btn btn-primary" data-toggle="collapse" href="#eventInformationSection-@count" role="button" aria-expanded="false"
                                                               aria-controls="eventInformationSection-@count" id="showEventInformationButton-@count"
                                                               onclick="toggleSection('showEventInformationButton-@count')">
                                                                @{
                                                                    string eventInformationIconId = $"showEventInformationButton-{@count}Icon";
                                                                }
                                                                <i id="@eventInformationIconId" class="fa-solid fa-chevron-up"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div id="eventInformationSection-@count" class="collapse show">
                                                        <div class="form-group">
                                                            <label for="title" class="control-label">Title</label>
                                                            <input class="form-control" id="title" value="@notification.EventOfNotification.Title" disabled="disabled" />
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="startingTime" class="control-label">Starting Time</label>
                                                            <input id="startingTime" type="datetime" class="form-control" value="@notification.EventOfNotification.StartingTime" disabled="disabled" />
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="endingTime" class="control-label">Ending Time</label>
                                                            <input id="endingTime" type="datetime" class="form-control" value="@notification.EventOfNotification.EndingTime" disabled="disabled" />
                                                        </div>
                                                        <div class="form-group">
                                                            <label for="description" class="control-label">Description</label>
                                                            <textarea class="form-control" id="description" disabled="disabled" rows="3">@notification.EventOfNotification.Description</textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="d-flex justify-content-between mt-2 mt-md-0">
                                                        <div></div>
                                                        <h4>Participants Section</h4>
                                                        <a class="btn btn-primary" data-toggle="collapse" href="#participationSection-@count" role="button" aria-expanded="false"
                                                           aria-controls="participationSection-@count" id="showParticipationButton-@count" onclick="toggleSection('showParticipationButton-@count')">
                                                            @{
                                                                string showParticipationIconId = $"showParticipationButton-{@count}Icon";
                                                            }
                                                            <i id="@showParticipationIconId" class="fa-solid fa-chevron-down"></i>
                                                        </a>
                                                    </div>

                                                    <div id="participationSection-@count" class="collapse">
                                                        <p> Members Who Participate In The Event: </p>
                                                        <div class="d-flex flex-wrap mt-3">
                                                            @foreach (User user in notification.EventOfNotification.UsersThatParticipateInTheEvent)
                                                            {
                                                                @if (!(notification.EventAccepted && notification.SenderUser.Username == user.Username))
                                                                {
                                                                    <span class="badge badge-primary mr-2 mb-2">@user.Username</span>
                                                                }
                                                            }
                                                            @if(notification.EventAccepted)
                                                            {
                                                                <span class="badge badge-success mr-2 mb-2">@notification.SenderUser.Username</span>
                                                            }
                                                            else if (notification.EventRejected)
                                                            {
                                                                <span class="badge badge-danger mr-2 mb-2">@notification.SenderUser.Username</span>
                                                            }
                                                        </div>
                                                    </div>

                                                    <div class="d-flex justify-content-between mt-3 mb-2">
                                                        <div></div>
                                                        <h4>Comments Section</h4>
                                                        <a class="btn btn-primary" data-toggle="collapse" href="#commentSection-@count" role="button" aria-expanded="false"
                                                           aria-controls="commentSection-@count" id="showCommentButton-@count" onclick="toggleSection('showCommentButton-@count')">
                                                            @{
                                                                string showCommentIconId = $"showCommentButton-{@count}Icon";
                                                            }
                                                            <i id="@showCommentIconId" class="fa-solid fa-chevron-down"></i>
                                                        </a>
                                                    </div>
                                                    <div id="commentSection-@count" class="collapse mt-2">
                                                        <div id="commentArea">
                                                            @if (notification.EventOfNotification.EventComments.Count == 0)
                                                            {
                                                                <div class="alert alert-info" role="alert" id="noComments">
                                                                    <strong>No comments!</strong> There are no comments yet.
                                                                </div>
                                                            }

                                                            @foreach (Comment comment in notification.EventOfNotification.EventComments)
                                                            {
                                                                <div class="card mb-2">
                                                                    <div class="card-header">
                                                                        <div class="d-flex justify-content-between">
                                                                            <h5 class="card-title font-weight-bold">
                                                                                <i class="fa-solid fa-user mr-1"></i> @comment.UserWhoMadeTheComment.Username
                                                                            </h5>
                                                                        </div>
                                                                        <p class="card-subtitle text-muted">@comment.CommentDate.ToString()</p>
                                                                    </div>
                                                                    <div class="card-body">
                                                                        @comment.CommentText
                                                                    </div>
                                                                </div>
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-dark" data-dismiss="modal">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- Delete Notification Modal -->
                            <div class="modal fade" id="myModal-@count" tabindex="-1" role="dialog" aria-labelledby="myModalLabel-@count" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="myModalLabel-@count">Notification Confirm Deletion Dialog</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <p>Are you sure you want to delete this notification?</p>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-dark" data-dismiss="modal">Cancel</button>
                                            <!--fill the form-->
                                            <form method="post" asp-controller="Home" asp-action="DeleteNotification">
                                                <input type="hidden" name="eventId" value="@notification.EventOfNotification.Id" />
                                                <input type="hidden" name="userSenderUsername" value="@notification.SenderUser.Username" />
                                                <input type="hidden" name="notificationTime" value="@notification.NotificationTime" />
                                                <button type="submit" class="btn btn-danger">Delete</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        //increase the count*
                        count++;
                    }
                }
                @if (initialCountSection2 == count)
                {
                    <div class="alert alert-info" role="alert">
                        <strong>No notifications!</strong> There are no notifications for this section.
                    </div>
                }
            </div>
            
        </div>
        <div class="col-sm-12 col-md-12 col-lg-6 marker mb-3">
            @{
                initialCountSection3 = count;
            }
            <div class="d-flex justify-content-between mt-3 mb-2">
                <div></div>
                <h4>Alert Status Notifications</h4>
                <a class="btn btn-primary" data-toggle="collapse" href="#alertStatusNotificationsSection" role="button" aria-expanded="false"
                   aria-controls="alertStatusNotificationsSection" id="showAlertStatusNotificationsButton">
                    <i id="showAlertStatusNotificationsButtonIcon" class="fa-solid fa-chevron-up"></i>
                </a>
            </div>
            <div id="alertStatusNotificationsSection" class="collapse show">
                @foreach (Notification notification in Model.Notifications)
                {
                    if (notification.AlertNotification)
                    {
                        <div class="notification-box" id="notification-box-@count">
                            <div class="flex-grow-1 d-flex justify-content-between align-items-top">
                                <p class="notification-title">The Event: <span style="font-weight:bold">@notification.EventOfNotification.Title</span><br> 
                                    Will Start In 1 Hour</p>
                                <div>
                                    <button type="button" class="btn btn-primary notification-btn notification-check-btn" data-toggle="modal" data-target="#viewModal-@count">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger notification-btn notification-close-btn" onclick="removeNotification('@count')">
                                        <i class="fa-solid fa-x"></i>
                                    </button>
                                    <button type="button" class="btn btn-danger notification-btn notification-close-btn" data-toggle="modal" data-target="#myModal-@count">
                                        <i class="fa-solid fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- View Event Modal -->
                        <div class="modal fade" id="viewModal-@count" tabindex="-1" role="dialog" aria-labelledby="viewModalLabel-@count" aria-hidden="true">
                            <div class="modal-dialog modal-lg" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="viewModalLabel-@count">Alert Status For Event <span style="font-weight:bold;">@notification.EventOfNotification.Title</span></h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <h4 class="text-center d-none d-sm-none d-md-block">Event Information</h4>
                                                <div class="d-block d-sm-block d-md-none">
                                                    <div class="d-flex justify-content-between mt-3 mb-2">
                                                        <div></div>
                                                        <h4>Event Information</h4>
                                                        <a class="btn btn-primary" data-toggle="collapse" href="#eventInformationSection-@count" role="button" aria-expanded="false"
                                                           aria-controls="eventInformationSection-@count" id="showEventInformationButton-@count"
                                                           onclick="toggleSection('showEventInformationButton-@count')">
                                                            @{
                                                                string eventInformationIconId = $"showEventInformationButton-{@count}Icon";
                                                            }
                                                            <i id="@eventInformationIconId" class="fa-solid fa-chevron-up"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div id="eventInformationSection-@count" class="collapse show">
                                                    <div class="form-group">
                                                        <label for="title" class="control-label">Title</label>
                                                        <input class="form-control" id="title" value="@notification.EventOfNotification.Title" disabled="disabled" />
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="startingTime" class="control-label">Starting Time</label>
                                                        <input id="startingTime" type="datetime" class="form-control" value="@notification.EventOfNotification.StartingTime" disabled="disabled" />
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="endingTime" class="control-label">Ending Time</label>
                                                        <input id="endingTime" type="datetime" class="form-control" value="@notification.EventOfNotification.EndingTime" disabled="disabled" />
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="description" class="control-label">Description</label>
                                                        <textarea class="form-control" id="description" disabled="disabled" rows="3">@notification.EventOfNotification.Description</textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="d-flex justify-content-between mt-2 mt-md-0">
                                                    <div></div>
                                                    <h4>Participants Section</h4>
                                                    <a class="btn btn-primary" data-toggle="collapse" href="#participationSection-@count" role="button" aria-expanded="false"
                                                       aria-controls="participationSection-@count" id="showParticipationButton-@count" onclick="toggleSection('showParticipationButton-@count')">
                                                        @{
                                                            string showParticipationIconId = $"showParticipationButton-{@count}Icon";
                                                        }
                                                        <i id="@showParticipationIconId" class="fa-solid fa-chevron-down"></i>
                                                    </a>
                                                </div>

                                                <div id="participationSection-@count" class="collapse">
                                                    <p> Members Who Participate In The Event: </p>
                                                    <div class="d-flex flex-wrap mt-3">
                                                        @foreach (User user in notification.EventOfNotification.UsersThatParticipateInTheEvent)
                                                        {
                                                            <span class="badge badge-primary mr-2 mb-2">@user.Username</span>
                                                        }
                                                    </div>
                                                </div>

                                                <div class="d-flex justify-content-between mt-3 mb-2">
                                                    <div></div>
                                                    <h4>Comments Section</h4>
                                                    <a class="btn btn-primary" data-toggle="collapse" href="#commentSection-@count" role="button" aria-expanded="false"
                                                       aria-controls="commentSection-@count" id="showCommentButton-@count" onclick="toggleSection('showCommentButton-@count')">
                                                        @{
                                                            string showCommentIconId = $"showCommentButton-{@count}Icon";
                                                        }
                                                        <i id="@showCommentIconId" class="fa-solid fa-chevron-down"></i>
                                                    </a>
                                                </div>
                                                <div id="commentSection-@count" class="collapse mt-2">
                                                    <div id="commentArea">
                                                        @if (notification.EventOfNotification.EventComments.Count == 0)
                                                        {
                                                            <div class="alert alert-info" role="alert" id="noComments">
                                                                <strong>No comments!</strong> There are no comments yet.
                                                            </div>
                                                        }

                                                        @foreach (Comment comment in notification.EventOfNotification.EventComments)
                                                        {
                                                            <div class="card mb-2">
                                                                <div class="card-header">
                                                                    <div class="d-flex justify-content-between">
                                                                        <h5 class="card-title font-weight-bold">
                                                                            <i class="fa-solid fa-user mr-1"></i> @comment.UserWhoMadeTheComment.Username
                                                                        </h5>
                                                                    </div>
                                                                    <p class="card-subtitle text-muted">@comment.CommentDate.ToString()</p>
                                                                </div>
                                                                <div class="card-body">
                                                                    @comment.CommentText
                                                                </div>
                                                            </div>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-dark" data-dismiss="modal">Cancel</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Delete Notification Modal -->
                        <div class="modal fade" id="myModal-@count" tabindex="-1" role="dialog" aria-labelledby="myModalLabel-@count" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="myModalLabel-@count">Notification Confirm Deletion Dialog</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <p>Are you sure you want to delete this notification?</p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-dark" data-dismiss="modal">Cancel</button>
                                        <!--fill the form-->
                                        <form method="post" asp-controller="Home" asp-action="DeleteNotification">
                                            <input type="hidden" name="eventId" value="@notification.EventOfNotification.Id" />
                                            <input type="hidden" name="userSenderUsername" value="@notification.SenderUser.Username" />
                                            <input type="hidden" name="notificationTime" value="@notification.NotificationTime" />
                                            <button type="submit" class="btn btn-danger">Delete</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        //increase the count*
                        count++;
                    }
                }
                @if (initialCountSection3 == count)
                {
                    <div class="alert alert-info" role="alert">
                        <strong>No notifications!</strong> There are no notifications for this section.
                    </div>
                }
            </div>
            
        </div>
    </div>
</div>

@section Scripts {
    <script>

        // Add the "col-3-large" class to columns when screen size is above 1200px (col-xl)
        function addCol3LargeClass() {
            const screenWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;

            if (screenWidth > 1800) {
                const columns = document.querySelectorAll('.marker');
                columns.forEach((column) => {
                    column.classList.add('col-xl-4');
                    column.classList.remove('col-xl-6');

                });
            }
            else {
                const columns = document.querySelectorAll('.marker');
                columns.forEach((column) => {
                    column.classList.add('col-xl-6');
                    column.classList.remove('col-xl-4');

                });
            }
        }

        // Call the function on page load and window resize
        window.addEventListener('load', addCol3LargeClass);
        window.addEventListener('resize', addCol3LargeClass);

        function removeNotification(count) {
            let notificationBox = document.getElementById("notification-box-" + count);
            if (notificationBox) {
                notificationBox.remove();
            }
        }

        //for severons icons change
        function toggleSection(buttonId) {
            console.log(buttonId);
            const buttonIcon = document.getElementById(buttonId + 'Icon');
            if (buttonIcon.classList.contains('fa-chevron-down')) {
                buttonIcon.classList.remove('fa-chevron-down');
                buttonIcon.classList.add('fa-chevron-up');

            } else {
                buttonIcon.classList.remove('fa-chevron-up');
                buttonIcon.classList.add('fa-chevron-down');
            }
        }

        document.getElementById("showInvitationsButton").addEventListener("click", function () {
            toggleSection("showInvitationsButton");
        });
        document.getElementById("showEventNotificationsButton").addEventListener("click", function () {
            toggleSection("showEventNotificationsButton");
        });
        document.getElementById("showAlertStatusNotificationsButton").addEventListener("click", function () {
            toggleSection("showAlertStatusNotificationsButton");
        });
    </script>
}